{
  "$schema": "https://raw.githubusercontent.com/jetify-com/devbox/0.15.1/.schema/devbox.schema.json",
  "packages": [
    "go@1.24.5",
    "gosec@2.22.7",
    "go-tools@2025.1.1",
    "cobra-cli@1.3.0"
  ],
  "shell": {
    "init_hook": [
      "echo 'ğŸš€ Go DevBox environment loaded!'",
      "echo \"Go version: $(go version)\"",
      "go mod download || echo 'No go.mod found yet'",
      "echo 'ğŸš€ Go mods downloaded.'"
    ],
    "scripts": {
      "dev": ["echo 'ğŸ”§ Starting development environment...'", "go run ."],
      "build": [
        "echo 'ğŸ”¨ Building Go application...'",
        "mkdir -p ./dist/",
        "go build -o dist/app .",
        "echo 'âœ… Build complete: ./dist/app'"
      ],
      "test": ["echo 'ğŸ§ª Running tests...'", "go test -v ./..."],
      "coverage": [
        "echo 'ğŸ“Š Running tests with coverage...'",
        "mkdir -p ./dist/coverage",
        "go test -race -coverprofile=./dist/coverage/coverage.out -covermode=atomic ./...",
        "go tool cover -html=./dist/coverage/coverage.out -o ./dist/coverage/coverage.html",
        "echo 'âœ… Coverage report generated in : ./dist/coverage/coverage.html'"
      ],
      "benchmark": [
        "echo 'âš¡ Running benchmarks...'",
        "mkdir -p ./dist/benchmark",
        "go test -bench=. -benchmem ./... | tee ./dist/benchmark/benchmark.txt",
        "echo 'âœ… Benchmark results saved to ./dist/benchmark/benchmark.txt'"
      ],
      "clean": [
        "echo 'ğŸ§¹ Cleaning build artifacts...'",
        "rm -rf dist/",
        "go clean"
      ],
      "deps": [
        "echo 'ğŸ“¦ Installing dependencies...'",
        "go mod tidy",
        "go mod download"
      ],
      "fmt": ["echo 'ğŸ¨ Formatting Go code...'", "go fmt ./..."],
      "lint": [
        "echo 'ğŸ” Linting Go code...'",
        "go vet ./...",
        "staticcheck ./..."
      ],
      "generate-documentation": [
        "echo 'ğŸ“„ Generating documentation...'",
        "go run generateDocs.go",
        "echo 'âœ… Documentation generated in ./docs/cli-commands'"
      ],
      "security": [
        "echo 'ğŸ”’ Running security checks with gosec...'",
        "gosec ./..."
      ],
      "install": ["echo 'ğŸ“¥ Installing application...'", "go install ."],
      "deploy": [
        "echo 'ğŸš€ Building production binaries from os.data and arch.data...'",
        "OSS_TYPE=$(cat os.os_type) || (echo 'No os.os_type found' && exit 1)",
        "ARCH_TYPE=$(cat arch.os_type) || (echo 'No arch.os_type found' && exit 1)",
        "VERSION=$(git describe --tags --always)",
        "mkdir -p ./dist/executables",
        "for os in $OSS_TYPE; do",
        "  for arch in $ARCH_TYPE; do",
        "    echo \"Building for OS: $os, ARCH: $arch\"",
        "    BIN_NAME=gitctx-$VERSION-$os-$arch",
        "    if [ \"$os\" = \"windows\" ]; then",
        "      BIN_NAME=\"$BIN_NAME.exe\"",
        "    fi",
        "    GOOS=$os GOARCH=$arch go build -ldflags=\"-s -w -X github.com/alexandreLITHAUD/gitctx/cmd.Version=$VERSION\" -trimpath -tags=netgo,osusergo -o ./dist/executables/$BIN_NAME .",
        "    chmod +x ./dist/executables/$BIN_NAME",
        "  done",
        "done",
        "echo 'âœ… All binaries built in ./dist/executables'"
      ],
      "all": [
        "echo 'ğŸ”„ Running full CI pipeline...'",
        "devbox run fmt",
        "devbox run lint",
        "devbox run security",
        "devbox run test",
        "devbox run coverage",
        "devbox run build"
      ]
    }
  }
}
